Глава 5 13.07 150

Добавление изображений. Создадим модель изображения, добавим ей лайки. Создадим форму основанную на изображении
в форме мы создадим функцию, которая проверяет расширение и которая сохраняет фотку по ссылке. Чтобы
использовать вторую функцию по https надо так установить
pip install --upgrade certifi
Добавляем url, view.
Теперь, добавим jQuery функцию, которая может добавлять create по дате. Однако я хз как ей пользоваться, поэтому
создадим поле для ссылки, в неё закидываем ссылку и по этой форме перекидывает на создание фотки.
Там мы можем её сохранить к юзеру (создав функции get_url) в профиль и потом отображать.

Большие фотки иногда бывают больно большие, поэтому можно использовать pip install easy-thumbnails, который их сократит.
Добавим это в installed apps  - 'easy_thumbnails',  и пропишем python manage.py migrate
Это добавляет тег   {% thumbnail image.image300x0 quality=100 %}. Который позволяет изменить размер картинки,
тут в ширину 300 и по высоте автоматическое. Так же четкость изображеения моно настроить параметром. Такая
картинка созраняется рядом с вашей.
 https://easy-thumbnails.readthedocs.io/ для документации

 Adding AJAX actions with jQuery 172 - 14.07
 AJAX используется для асинхронной отправки запросов на сервер, без обнавления страницы.
 Добавим view который принимает только POST и так же требует логина. В нём будем возвращаеть JSON строку.
 Добавим функцию, которая качает AJAX. Так же для запросов нам всё ещё надо поддерживать CSRF токен чтобы нас не крякнули.

Теперь в detail добавляем главный скрипт. Он накладывается на <a> тег, отменяет его действие (переход по ссылыке),
отслеживает клик по нему, после клика, мы послыаем на наш адрес запрос, тот добавляет/убирает лайк и возвращает нам ответ,
взависимости от того, какое действие мы сделали, мы добавляем или убираем лайк в span. Помимо этого все аватарки вырисовываются.
Вообще все скрипты лучше хранить в статике, но мы хитрые и сильно много не потребляем, поэтому немного считерили.

Теперь добавим бесконечную пагинацию через AJAX. Добавим в view функцию, которая будет отвечать доп инфой если это Get с
определёнными фоточками, а так же обычный ответ на всё дело. Теперь в jQuery вставим проверку на низ и если это
низ то будем добавлять то, что возвращает функция, которая выше, спагинировавшая уже наши х картинок.
Добавим туда формочку для создания. PROFIT
